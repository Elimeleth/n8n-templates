{
  "nodes": [
    {
      "parameters": {
        "path": "b9ac2635-60cf-4284-8330-0362242e191d"
      },
      "type": "@n8n/n8n-nodes-langchain.mcpTrigger",
      "typeVersion": 2,
      "position": [
        -128,
        -224
      ],
      "id": "fb45e902-f805-46a2-9113-2da6798a3b50",
      "name": "MCP Server Trigger",
      "webhookId": "b9ac2635-60cf-4284-8330-0362242e191d"
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Agrega un nuevo recordatorio",
        "dataTableId": {
          "__rl": true,
          "value": "ZF61nXWPbrTrTc7T",
          "mode": "list",
          "cachedResultName": "reminders",
          "cachedResultUrl": "/projects/RTUxSaWTNyTCymto/datatables/ZF61nXWPbrTrTc7T"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "reminder": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('reminder', `El recordatorio que agregara el usuario`, 'string') }}",
            "reminder_date": "={{ DateTime.fromISO($fromAI('reminder_date', `La fecha del recordatorio en formato ISO`, 'string')) }}",
            "telefono": "1869174190"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "reminder",
              "displayName": "reminder",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "reminder_date",
              "displayName": "reminder_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "telefono",
              "displayName": "telefono",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.dataTableTool",
      "typeVersion": 1,
      "position": [
        -304,
        0
      ],
      "id": "1f6314a5-bec6-46cd-9bab-efe748ef606a",
      "name": "agregar"
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Elimina un recordatorio",
        "operation": "deleteRows",
        "dataTableId": {
          "__rl": true,
          "value": "ZF61nXWPbrTrTc7T",
          "mode": "list",
          "cachedResultName": "reminders",
          "cachedResultUrl": "/projects/RTUxSaWTNyTCymto/datatables/ZF61nXWPbrTrTc7T"
        },
        "filters": {
          "conditions": [
            {
              "keyValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('conditions0_Value', `identificador del reminder`, 'string') }}"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.dataTableTool",
      "typeVersion": 1,
      "position": [
        -176,
        0
      ],
      "id": "f4d6cd28-d467-4453-af13-1a7efbe55592",
      "name": "eliminar"
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Actualiza un recordatorio",
        "operation": "update",
        "dataTableId": {
          "__rl": true,
          "value": "ZF61nXWPbrTrTc7T",
          "mode": "list",
          "cachedResultName": "reminders",
          "cachedResultUrl": "/projects/RTUxSaWTNyTCymto/datatables/ZF61nXWPbrTrTc7T"
        },
        "filters": {
          "conditions": [
            {
              "keyValue": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('conditions0_Value', `identificador del reminder`, 'string') }}"
            }
          ]
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "reminder": "={{ /*n8n-auto-generated-fromAI-override*/ $fromAI('reminder', `El recordatorio a actualizar o el mismo`, 'string') }}",
            "reminder_date": "={{ DateTime.fromISO($fromAI('reminder_date', `La fecha del recordatorio en formato ISO`, 'string')) }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "reminder",
              "displayName": "reminder",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "reminder_date",
              "displayName": "reminder_date",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "telefono",
              "displayName": "telefono",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.dataTableTool",
      "typeVersion": 1,
      "position": [
        -48,
        0
      ],
      "id": "eeaabb71-cc4c-4d4e-993a-7a3ab7c8475e",
      "name": "actualizar"
    },
    {
      "parameters": {
        "descriptionType": "manual",
        "toolDescription": "Lista los recordatorios",
        "operation": "get",
        "dataTableId": {
          "__rl": true,
          "value": "ZF61nXWPbrTrTc7T",
          "mode": "list",
          "cachedResultName": "reminders",
          "cachedResultUrl": "/projects/RTUxSaWTNyTCymto/datatables/ZF61nXWPbrTrTc7T"
        },
        "returnAll": true
      },
      "type": "n8n-nodes-base.dataTableTool",
      "typeVersion": 1,
      "position": [
        80,
        0
      ],
      "id": "2f35e83f-6c4e-4a01-87f2-5484a1bd70d5",
      "name": "listar"
    },
    {
      "parameters": {
        "description": "Obten la lista de fechas del mes para poder hacer busqueda de disponibilidad",
        "jsCode": "function getMonthWeekdayMap(year, month) {\n  const weekdays = [\n    \"lunes\",\n    \"martes\",\n    \"miercoles\",\n    \"jueves\",\n    \"viernes\",\n    \"sabado\",\n    \"domingo\"\n  ];\n\n  const createEmptyResult = () => ({\n    lunes: [],\n    martes: [],\n    miercoles: [],\n    jueves: [],\n    viernes: [],\n    sabado: [],\n    domingo: []\n  });\n\n  const result = createEmptyResult();\n\n  const today = new Date();\n  today.setHours(0, 0, 0, 0);\n\n  const fillMonth = (y, m) => {\n    const jsMonth = m - 1;\n    const date = new Date(y, jsMonth, 1);\n\n    while (date.getMonth() === jsMonth) {\n      const current = new Date(date);\n\n      if (current >= today) {\n        const dayIndex = (current.getDay() + 6) % 7;\n        const dayName = weekdays[dayIndex];\n        const formatted = current.toISOString().split(\"T\")[0];\n        result[dayName].push(formatted);\n      }\n\n      date.setDate(date.getDate() + 1);\n    }\n  };\n\n  // Mes actual\n  fillMonth(year, month);\n\n  // Mes siguiente\n  const nextMonth = month === 12 ? 1 : month + 1;\n  const nextYear = month === 12 ? year + 1 : year;\n  fillMonth(nextYear, nextMonth);\n\n  return result;\n}\n\n// Ejemplo:\nreturn JSON.stringify(getMonthWeekdayMap($now.year, $now.month));\n"
      },
      "type": "@n8n/n8n-nodes-langchain.toolCode",
      "typeVersion": 1.3,
      "position": [
        208,
        0
      ],
      "id": "aaab2904-9249-4338-93a3-9444fa502cae",
      "name": "dates"
    }
  ],
  "connections": {
    "agregar": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "eliminar": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "actualizar": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "listar": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "dates": {
      "ai_tool": [
        [
          {
            "node": "MCP Server Trigger",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    }
  },
  "pinData": {},
  "meta": {}
}